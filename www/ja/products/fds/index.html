<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="ja" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<title>AKABANA - S2Factory - FDS2(Beta2)</title>
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/main.css" media="screen,projection" />
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/print.css" media="print" />
<link href="./css/maven-base.css" type="text/css" rel="stylesheet" media="screen" />
<link href="./css/maven-theme.css" type="text/css" rel="stylesheet" media="screen" />
</head>
<body>
<div id="wrapper">
  <div id="header">
    <div class="line"><span class="hide">spacer</span></div>
    <div id="logo">
      <h1 id="h01" class="hide">The Seasar Foundation Project Site</h1>
      <img src="../../images/logo-rc1.png" alt="The Seasar Foundation" width="400" height="110" align="LEFT"  /><img align="RIGHT"  alt="Akabana Project" height="110" src="../../images/seasar-logo.png" width="254"/></div>
    <div id="tool">
      <!--
<h2><a href="http://search.seasar.org/">Site Search</a></h2>

<form id="search" action="http://search.seasar.org/">
<div>
	<input id="search_phrase" type="text" name="phrase" size="20" />
	<input type="hidden" name="perpage" value="30" />
	<input type="hidden" name="enc" value="UTF-8" />
	<input id="search_go" type="submit" value="Search" />
</div>
</form>

<h2>Seasar Banner</h2>

<p><a href="http://www.seasar.org/images/seasar_banner.gif"><img src="http://www.seasar.org/images/seasar_banner.gif" alt="Seasar Banner" title="Seasar Banner" width="146" height="33" /></a></p>
-->
    </div>
    <div id="navi">
      <p><a href="../en/">English</a> | <a href="../ja/">Japanese</a></p>
    </div>
  </div>
  <!-- header -->
  <div id="contents_left">
    <h2>Menu</h2>
    <ul>
      <li class="none"> <strong>Introduction</strong> </li>
      <li class="none"> <a href="#Download">Download</a> </li>
      <li class="none"> <a href="#">Tutorials</a> </li>
      <li class="none"> <a href="#">Examples</a> </li>
      <li class="none"> <a href="#">User's Guide</a> </li>
      <li class="none"> <a href="#">Development's Guide</a> </li>
      <li class="none"> <a href="apidocs/index.html">API Javadoc</a> </li>
      <li class="none"> <a href="#">FAQ</a> </li>
    </ul>
    <h2>プロジェクト文書</h2>
    <ul>
      <li class="expanded"> <a href="../../project-info.html">プロジェクト情報</a>
        <ul>
          <li class="none"> <strong>このプロジェクトについて</strong> </li>
          <li class="none"> <a href="../../source-repository.html">ソースリポジトリ</a> </li>
          <li class="none"> <a href="../../project-summary.html">プロジェクトサマリ</a> </li>
          <li class="none"> <a href="../../team-list.html">プロジェクトチーム</a> </li>
          <li class="none"> <a href="../../license.html">プロジェクトライセンス</a> </li>
          <li class="none"> <a href="../../mail-lists.html">メーリングリスト</a> </li>
          <li class="none"> <a href="../../dependencies.html">依存関係</a> </li>
          <li class="none"> <a href="../../issue-tracking.html">課題追跡</a> </li>
          <li class="none"> <a href="../../integration.html">継続的結合</a> </li>
        </ul>
      </li>
    </ul>
    <a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy" name="poweredBy"> <img alt="Built by Maven" src="./images/logos/maven-feather.png" /> </a> </div>
  <!-- contents_left -->
  <div id="contents_center">
    <div id="article">
      <div class="section">
        <h2>S2Factory for FDS2(Beta2)</h2>
        <p>FDS2(Flex Data Services 2)とSeasar 2/S2Flex2 を統合するものです。 </p>
        <h2> <a name="Overview">概要</a></h2>
        <p>FDS2 s2Factoryは、fds2(Flex Data Services 2)と、DIxAOPコンテナであるSeasar2に登録されたコンポーネントを呼び出すことを可能にするFactoryです。<br />
        FDS2で用意されているFactory Mechanismを利用してS2Flex2の処理部分を呼び出します。</p>
        <p>flex.messaging.FlexFactoryを実装したRemotingServiceInvokerを用意することでFDS2からs2flex2のロジック呼び出しを可能にしています。</p>
        <h2><a name="Features">機能</a></h2>
        <ul>
        	<li>FDS 2の設定ファイルに記述されたserviceをもとにS2Containerに登録されているコンポーネントを呼び出します。</li>
        	<li>RemotingService(meta/Annotation)の有無による呼び出しコンポーネントの制限 </li>
        	<li>アノテーションによるSessionからデータのimport,SessionへのデータExportをサポート </li>
        </ul>	
        <h2><a name="Download">ダウンロード</a></h2>
        <p> <a href="/">akabana</a>のサイトより<a href="../../../downloads.html">download</a>することができます。<br />
          また、<a href="../../source-repository.html">ソースリポジトリ</a>より最新のものをチェックアウトすることも可能です。 </p>
        <h2><a name="Prerequisites" id="Prerequisites"></a>前提条件</h2>
        <p><br />
          FDS s2Factoryを利用するには以下のものを必要とします。</p>
        <ul>
          <li><a href="http://www.flex.org/" target="external">Flex Data Services2</a></li>
          <li><a href="http://s2flex2.sandbox.seasar.org/" target="external">S2Flex2</a></li>
          <li><a href="http://s2container.seasar.org/" target="exernal">S2 Container2 2.4</a></li>
        </ul>
        <p> その他S2Flex2/S2Containerで必要なものを一緒にdeployする必要があります。</p>
        <h2><a name="Install" id="Install">インストール</a> </h2>
        <p> FDS用のS2Factoryをインストールして使用するには</p>
         <h4>jarの配置</h4>
         <p> s2flex2/S2Containerを利用する上で必要なファイルをコピーします。 </p>
         <ul>
           <li>aopalliance-1.0.jar</li>
           <li>geronimo-jta_1.0.1B_spec-1.0.jar</li>
           <li>javassist-3.0.jar</li>
           <li>log4j-1.2.13.jar</li>
           <li>ognl-2.6.7.jar</li>
           <li>s2-extension-2.4.x.jar</li>
           <li>s2-framework-2.4.x.jar</li>
          <li>s2-fds-s2factory-b2.jar</li>
           <li>s2-flex2-1.0.x.jar</li>
         </ul>
        <h4>web.xmlの更新</h4>
        <p>S2flex2を利用する為に必要な設定を追加します。<br />
        web.xmlに以下の記述を追加します。</p>
<!--        
        servletの設定
        <pre>
   &lt;servlet&gt;
   &lt;servlet-name&gt;s2servlet&lt;/servlet-name&gt;
   &lt;servlet-class&gt;org.seasar.framework.container.servlet.S2ContainerServlet&lt;/servlet-class&gt;
   &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
   &lt;/servlet&gt;

   &lt;servlet-name&gt;s2servlet&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/s2servlet&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;
</pre>-->
		<p>filterの設定</p>
        <pre>
   &lt;filter&gt;
   &lt;filter-name&gt;s2filter&lt;/filter-name&gt;
   &lt;filter-class&gt;org.seasar.framework.container.filter.S2ContainerFilter&lt;/filter-class&gt;
   &lt;/filter&gt;
   
   &lt;filter-mapping&gt;
   &lt;filter-name&gt;s2filter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/filter-mapping&gt;
           </pre>
        <p>　　　上記設定を追加したweb.xmlをresources以下にサンプルとして用意しています。</p>
        <h4>factoryを利用する設定(services-config.xml)</h4>
        <br />
        <p>services-config.xmlに以下の設定を追加します。</p>
        <p>追加する場所は、&lt;services-config&gt;タグの下になります。</p>
<pre>&lt;factories&gt;
	&lt;factory id=&quot;s2&quot; class=&quot;org.seasar.flex2.rpc.remoting.service.fds2.factory.Seasar2Factory&quot; /&gt;
&lt;/factories&gt;</pre>
        <p><br>
          上記のservices-config.xmlの記述例をresources以下にサンプルとして用意しています。 </p>
        <h2> <a name="Usage" id="Usage">使い方</a></h2>
        <h4>サービスの追加</h4>
        <p>　　　remoting-config.xmlにFlexクライアントから呼び出すserviceの設定を追加します。<br />
          以下はaddServiceというサービスを設定する場合の例です。</p>
        <pre>&lt;destination id=&quot;addService&quot;&gt;
   &lt;properties&gt;
   &lt;factory&gt;s2&lt;/factory&gt;
   &lt;/properties&gt;
&lt;/destination&gt;</pre>
        <p><br>
          factoryタグにservices-config.xmlで指定したFactoryのIDを指定します。</p>
        <h4> remotingServiceを使ったServiceの呼び出し制限</h4>
        <p><br />
          S2flex2同様Flex2 クライアントから呼び出すことのできるServiceコンポーネントを制限することができます。<br />
          FDS2では、設定されたコンポーネント以外は呼び出すことができないようになっています。<br />
          S2Flex2を通じてS2Containerに登録されたコンポーネントを呼び出す際には、RemotingServiceが設定されていなければなりません。<br />
          RemotingServiceは以下の方法で登録することが可能です。</p>
        <ul>
			<li>アノテーション(JDK5.0) </li>
          <li>定数アノテーション(JDK1.4.x) </li>   
	    </ul>           
            <p>
              いづれの方法でも登録されていないときには、AutoRegisterでも、SmartDeployでのCustomizerでもServiceクラスにMeta情報が登録されません。
              RemotingSericeが設定されていないServiceは、Flexクライアントから呼び出すことができません。<br />
              通常FDS2 ではremoting-config.xmlにSevriceを記述すれば呼び出す事が可能になりますが、S2Factoryを利用するときには、remoting-config.xmlに加えてRemotingServiceが定義されている必要があります。</p>
			<h5>アノテーション</h5>
              <p>JDK5.0のときには、アノテーションを利用してRemotingServiceを指定することができます。<br />
              例）</p>
              <pre>
<b>@RemotingService</b>
public class AddServiceImpl implements AddService {
	:
	:
}
			</pre>
              <p>上記のRemotingServiceは、S2lex2-tigerに含まれています。<br />
              アノテーションで設定するときには、S2Flex2とともにS2flex2-tigerを一緒にご利用ください。</p>
              <p>flex2-fds-exampleはこのアノテーションを利用してFlex 2クライアントからServiceとして呼び出せるようにしています。</p>
            
			 <h5>定数アノテーション</h5>
			 
			 <p>JDK1.4環境では、定数アノテーションを指定することで、ServiceとしてFlex 2クライアントから呼び出すことが可能になります。<br />
			 また、JDK5.0環境においても、S2Flex2-tigerがクラスパス上に無いときには、定数アノテーションで指定します。<br />
           例）</p>
              <pre>

public class AddServiceImpl implements AddService {
	<b>public static final String REMOTING_SERVICE = "addService";</b>
:
:
}
</pre>
<h4>RemotingServiceの登録</h4>
<p>アノテーションまたは、定数アノテーションでService単位に設定した後、Containerに登録する必要があります。<br />
登録するには、以下の方法があります。</p>
	<ul>
      <li>Customizerによる登録 </li>
      <li>AutoRegisterによる登録</li>
    </ul>
 <h5>Customizerによる登録</h5>
<p>S2 Container 2.4から導入されたSmartDeployを利用するには、Customizerを利用します。customizer.dicon</p>
<pre>
&lt;component
	name=&quot;remotingServiceCustomizer&quot;
	class=&quot;org.seasar.flex2.rpc.remoting.service.customizer.RemotingServiceCustomizer&quot;&gt;
&lt;/component&gt;
</pre>
    
              <h5>AutoRegisterによる登録</h5>
              <p>diconファイルで、以下のように指定します。</p>
              <pre>
&lt;component
  class=&quot;org.seasar.flex2.rpc.remoting.service.autoregister.FileSystemRemotingServiceAutoRegister"&gt;
    &lt;initMethod name=&quot;addClassPattern&quot;&gt;
        <strong>&lt;arg&gt;&quot;examples.flex2&quot;&lt;/arg&gt;</strong>
        <strong>&lt;arg&gt;&quot;.*ServiceImpl&quot;&lt;/arg>&gt;</strong>
    &lt;/initMethod&gt;
    &lt;initMethod name=&quot;addClassPattern&quot;&gt;
        <strong>&lt;arg&gt;&quot;examples.flex2&quot;&lt;/arg&gt;</strong>
        <strong>&lt;arg&gt;&quot;.*FacadeImpl&quot;&lt;/arg&gt;</strong>
    &lt;/initMethod&gt;
&lt;/component&gt;
	</pre>
<p>addClassPatternで指定するのは、第一引数がrootになるパッケージ、第二引数が登録するクラスパターンになります。<br/>
上記の例では、example.flex2から始まるパッケージでServiceImplで終わるクラスを登録します。<br/
addClassPatternは複数指定することができます。登録したいパターンだけ並べます。上記では、ひとつめのAddClassPatternでServiceImplで終わるクラスを、２つめのAddClassPatternでFacadeImplで終わるクラスもRemotingServiceを登録しています。</p>

      </div>
    </div>
    <!-- article -->
  </div>
  <!-- contents_center -->
  <div id="footer">
    <address>
    &copy; Copyright 2006, The Seasar Foundation and the others. All rights reserved.
    </address>
    <div class="line"><span class="hide">spacer</span></div>
  </div>
  <!-- footer -->
</div>
<!-- wrapper -->
</body>
</html>
